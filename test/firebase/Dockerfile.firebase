FROM node:20-alpine

# Dependencias para firebase-tools e emulador
RUN apk add --no-cache \
    openjdk21-jre \
    curl \
    bash

RUN npm install -g firebase-tools@latest

WORKDIR /app

EXPOSE 4000 9099

HEALTHCHECK --interval=10s --timeout=5s --start-period=30s --retries=3 \
  CMD curl -f http://localhost:4000 || exit 1

CMD ["firebase", "emulators:start", "--project", "demo-project"]
